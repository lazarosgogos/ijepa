INFO:root:called-params cls_configs/cls-in100-multi.yaml
INFO:root:loaded params....
{   'data': {   'batch_size': 128,
                'crop_size': 224,
                'model_name': 'vit_base',
                'num_classes': 100,
                'patch_size': 14,
                'probe_checkpoints': False,
                'probe_prefix': 'jepa_in100',
                'train_dataset_path': 'datasets/imagenet100/train',
                'val_dataset_path': 'datasets/imagenet100/val'},
    'logging': {   'checkpoint_freq': 1000,
                   'eval_output': 'ocls-jepa-in100-l2-seed0.out',
                   'log_dir': 'logs_IN100/in100-vitb-l2-seed0/',
                   'log_file': 'stats-in100-l2-seed0.csv',
                   'save_path': 'classifiers/jepa-stl-l2-seed2-classifier-pretrained-vitb'},
    'message': 'Multi classification back to back',
    'meta': {'device': 'cuda:0', 'feature_extract': False},
    'multi_probing': ['logs_IN100/in100-vitb-l2-seed0/'],
    'optimization': {   'epochs': 200,
                        'lr': 0.001,
                        'use_last_n_blocks': 1,
                        'use_normalization': False}}
INFO:root:working on file logs_IN100/in100-vitb-l2-seed0/jepa_in100-ep200.pth.tar ...
Directory logs_IN100/in100-vitb-l2-seed0/classifiers for saving the classifiers is now present
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(14, 14), stride=(14, 14))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
Epoch: 1/200 Train accuracy: 1.21731e-01 Validation accuracy: 1.38200e-01 Training loss 3.53238e-02 Validation loss 3.60057e-02Time taken: 1485.74 seconds 
Epoch: 2/200 Train accuracy: 1.65777e-01 Validation accuracy: 1.56600e-01 Training loss 3.49703e-02 Validation loss 3.58544e-02Time taken: 1301.33 seconds 
Epoch: 3/200 Train accuracy: 1.80492e-01 Validation accuracy: 1.71200e-01 Training loss 3.48471e-02 Validation loss 3.57624e-02Time taken: 1299.16 seconds 
Epoch: 4/200 Train accuracy: 1.88400e-01 Validation accuracy: 1.77400e-01 Training loss 3.47763e-02 Validation loss 3.57201e-02Time taken: 1307.00 seconds 
Epoch: 5/200 Train accuracy: 1.93862e-01 Validation accuracy: 1.79800e-01 Training loss 3.47275e-02 Validation loss 3.56889e-02Time taken: 1365.41 seconds 
Epoch: 6/200 Train accuracy: 2.01115e-01 Validation accuracy: 1.80000e-01 Training loss 3.46765e-02 Validation loss 3.56586e-02Time taken: 1321.34 seconds 
Epoch: 7/200 Train accuracy: 2.05538e-01 Validation accuracy: 1.85800e-01 Training loss 3.46386e-02 Validation loss 3.56298e-02Time taken: 1347.87 seconds 
Epoch: 8/200 Train accuracy: 2.09446e-01 Validation accuracy: 1.88600e-01 Training loss 3.46053e-02 Validation loss 3.56078e-02Time taken: 1338.88 seconds 
Epoch: 9/200 Train accuracy: 2.13315e-01 Validation accuracy: 1.90400e-01 Training loss 3.45794e-02 Validation loss 3.55966e-02Time taken: 1319.36 seconds 
Epoch: 10/200 Train accuracy: 2.15738e-01 Validation accuracy: 1.89600e-01 Training loss 3.45580e-02 Validation loss 3.55821e-02Time taken: 1314.59 seconds 
Epoch: 11/200 Train accuracy: 2.18331e-01 Validation accuracy: 1.90600e-01 Training loss 3.45375e-02 Validation loss 3.55755e-02Time taken: 1307.40 seconds 
Epoch: 12/200 Train accuracy: 2.22369e-01 Validation accuracy: 1.97800e-01 Training loss 3.45099e-02 Validation loss 3.55411e-02Time taken: 1292.43 seconds 
Epoch: 13/200 Train accuracy: 2.25008e-01 Validation accuracy: 1.93800e-01 Training loss 3.44902e-02 Validation loss 3.55400e-02Time taken: 1298.39 seconds 
Epoch: 14/200 Train accuracy: 2.26492e-01 Validation accuracy: 1.98000e-01 Training loss 3.44735e-02 Validation loss 3.55261e-02Time taken: 1296.24 seconds 
Epoch: 15/200 Train accuracy: 2.30623e-01 Validation accuracy: 2.01800e-01 Training loss 3.44482e-02 Validation loss 3.55071e-02Time taken: 1302.47 seconds 
Epoch: 16/200 Train accuracy: 2.34608e-01 Validation accuracy: 2.02400e-01 Training loss 3.44211e-02 Validation loss 3.54875e-02Time taken: 1341.99 seconds 
slurmstepd: error: *** JOB 1841037 ON cn50 CANCELLED AT 2024-10-27T04:44:07 DUE TO TIME LIMIT ***

nohup: ignoring input
INFO:root:called-params configs/iic-train.yaml
INFO:root:loaded params...
{   'data': {   'batch_size': 64,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.3, 1.0],
                'crop_size': 150,
                'image_folder': 'intel-image-classification/',
                'num_workers': 10,
                'pin_mem': True,
                'root_path': 'datasets',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'logging': {   'checkpoint_freq': 100,
                   'folder': 'logs_PKT/iic-train-L2_PKT/',
                   'logging_frequency': 1,
                   'write_tag': 'jepa_iic_L2_PKT'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 1,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 15,
                'pred_mask_scale': [0.15, 0.2]},
    'meta': {   'copy_data': False,
                'load_checkpoint': False,
                'model_name': 'vit_base',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': None,
                'use_bfloat16': False},
    'optimization': {   'ema': [0.996, 1.0],
                        'epochs': 500,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'loss_function': 'L2_PKT',
                        'lr': 0.001,
                        'start_lr': 0.0002,
                        'warmup': 40,
                        'weight_decay': 0.04}}
INFO:root:Running... (rank: 0/2)
INFO:root:Initialized (rank/world-size) 0/2
INFO:root:VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
INFO:root:making imagenet data transforms
INFO:root:data-path datasets/intel-image-classification/train/
INFO:root:Initialized ImageNet
INFO:root:ImageNet dataset created
INFO:root:ImageNet unsupervised data loader created
INFO:root:Using AdamW
INFO:root:Epoch 1
{   'data': {   'batch_size': 64,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.3, 1.0],
                'crop_size': 150,
                'image_folder': 'intel-image-classification/',
                'num_workers': 10,
                'pin_mem': True,
                'root_path': 'datasets',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'logging': {   'checkpoint_freq': 100,
                   'folder': 'logs_PKT/iic-train-L2_PKT/',
                   'logging_frequency': 1,
                   'write_tag': 'jepa_iic_L2_PKT'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 1,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 15,
                'pred_mask_scale': [0.15, 0.2]},
    'meta': {   'copy_data': False,
                'load_checkpoint': False,
                'model_name': 'vit_base',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': None,
                'use_bfloat16': False},
    'optimization': {   'ema': [0.996, 1.0],
                        'epochs': 500,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'loss_function': 'L2_PKT',
                        'lr': 0.001,
                        'start_lr': 0.0002,
                        'warmup': 40,
                        'weight_decay': 0.04}}
INFO:root:[1,     0] loss: 4.881067e-01 masks: 23.0 16.0 [wd: 4.00e-02] [lr: 2.00e-04] [mem: 5.57e+03] (10079.0 ms)
INFO:root:[1,     0] grad_stats: [2.26e-02 1.27e-02] (1.26e-02, 3.36e-02)
INFO:root:avg. loss 1.76729934e-01
INFO:root:time taken for epoch 0:01:26.062711
INFO:root:Epoch 2
INFO:root:[2,     0] loss: 1.668419e-01 masks: 20.0 16.0 [wd: 4.00e-02] [lr: 2.20e-04] [mem: 7.55e+03] (496.0 ms)
INFO:root:[2,     0] grad_stats: [6.30e-02 1.48e-03] (1.48e-03, 8.37e-02)
INFO:root:avg. loss 1.49539539e-01
INFO:root:time taken for epoch 0:01:18.385184
INFO:root:Epoch 3
INFO:root:[3,     0] loss: 1.526487e-01 masks: 16.0 20.0 [wd: 4.00e-02] [lr: 2.40e-04] [mem: 7.66e+03] (482.8 ms)
INFO:root:[3,     0] grad_stats: [5.71e-02 1.24e-03] (1.22e-03, 8.87e-02)
INFO:root:avg. loss 1.34972556e-01
INFO:root:time taken for epoch 0:01:18.134063
INFO:root:Epoch 4
INFO:root:[4,     0] loss: 1.196798e-01 masks: 17.0 20.0 [wd: 4.00e-02] [lr: 2.60e-04] [mem: 7.66e+03] (518.2 ms)
INFO:root:[4,     0] grad_stats: [3.90e-02 1.17e-03] (7.86e-04, 6.36e-02)
INFO:root:avg. loss 1.09204585e-01
INFO:root:time taken for epoch 0:01:18.539735
INFO:root:Epoch 5
INFO:root:[5,     0] loss: 1.163360e-01 masks: 14.0 20.0 [wd: 4.01e-02] [lr: 2.80e-04] [mem: 7.66e+03] (475.1 ms)
INFO:root:[5,     0] grad_stats: [2.95e-02 8.00e-04] (5.71e-04, 4.33e-02)
INFO:root:avg. loss 8.56883260e-02
INFO:root:time taken for epoch 0:01:18.409709
INFO:root:Epoch 6
INFO:root:[6,     0] loss: 6.776140e-02 masks: 23.0 16.0 [wd: 4.01e-02] [lr: 3.00e-04] [mem: 7.80e+03] (515.6 ms)
INFO:root:[6,     0] grad_stats: [3.78e-02 7.86e-04] (7.23e-04, 5.42e-02)
INFO:root:avg. loss 6.65662729e-02
INFO:root:time taken for epoch 0:01:18.124210
INFO:root:Epoch 7
INFO:root:[7,     0] loss: 5.948955e-02 masks: 25.0 16.0 [wd: 4.01e-02] [lr: 3.20e-04] [mem: 7.80e+03] (529.6 ms)
INFO:root:[7,     0] grad_stats: [2.36e-02 7.20e-04] (5.90e-04, 4.06e-02)
INFO:root:avg. loss 5.43782074e-02
INFO:root:time taken for epoch 0:01:17.823253
INFO:root:Epoch 8
INFO:root:[8,     0] loss: 4.514445e-02 masks: 23.0 20.0 [wd: 4.02e-02] [lr: 3.40e-04] [mem: 7.80e+03] (530.2 ms)
INFO:root:[8,     0] grad_stats: [1.85e-02 4.68e-04] (3.58e-04, 2.72e-02)
INFO:root:avg. loss 4.66604149e-02
INFO:root:time taken for epoch 0:01:18.340446
INFO:root:Epoch 9
INFO:root:[9,     0] loss: 5.032175e-02 masks: 14.0 20.0 [wd: 4.02e-02] [lr: 3.60e-04] [mem: 7.80e+03] (476.0 ms)
INFO:root:[9,     0] grad_stats: [1.46e-02 4.57e-04] (2.96e-04, 1.98e-02)
INFO:root:avg. loss 4.21504874e-02
INFO:root:time taken for epoch 0:01:20.387165
INFO:root:Epoch 10
INFO:root:[10,     0] loss: 4.134550e-02 masks: 19.0 20.0 [wd: 4.03e-02] [lr: 3.80e-04] [mem: 7.80e+03] (501.8 ms)
INFO:root:[10,     0] grad_stats: [1.26e-02 3.75e-04] (2.43e-04, 2.15e-02)
INFO:root:avg. loss 3.86468965e-02
INFO:root:time taken for epoch 0:01:19.101046
INFO:root:Epoch 11
INFO:root:[11,     0] loss: 3.788085e-02 masks: 17.0 20.0 [wd: 4.04e-02] [lr: 4.00e-04] [mem: 7.80e+03] (513.1 ms)
INFO:root:[11,     0] grad_stats: [1.38e-02 1.06e-03] (4.01e-04, 2.06e-02)
INFO:root:avg. loss 3.63836239e-02
INFO:root:time taken for epoch 0:01:18.629016
INFO:root:Epoch 12
INFO:root:[12,     0] loss: 3.422900e-02 masks: 17.0 20.0 [wd: 4.04e-02] [lr: 4.20e-04] [mem: 7.80e+03] (495.7 ms)
INFO:root:[12,     0] grad_stats: [1.91e-02 6.88e-04] (3.55e-04, 3.55e-02)
INFO:root:avg. loss 3.69839036e-02
INFO:root:time taken for epoch 0:01:18.709676
INFO:root:Epoch 13
INFO:root:[13,     0] loss: 4.044027e-02 masks: 17.0 20.0 [wd: 4.05e-02] [lr: 4.40e-04] [mem: 7.80e+03] (490.3 ms)
INFO:root:[13,     0] grad_stats: [1.15e-02 4.45e-04] (2.16e-04, 1.96e-02)
INFO:root:avg. loss 3.71370226e-02
INFO:root:time taken for epoch 0:01:18.357206
INFO:root:Epoch 14
INFO:root:[14,     0] loss: 3.130269e-02 masks: 25.0 16.0 [wd: 4.06e-02] [lr: 4.60e-04] [mem: 7.80e+03] (530.7 ms)
INFO:root:[14,     0] grad_stats: [9.55e-03 5.49e-04] (2.00e-04, 1.41e-02)
INFO:root:avg. loss 3.66438001e-02
INFO:root:time taken for epoch 0:01:18.463139
INFO:root:Epoch 15
INFO:root:[15,     0] loss: 3.879821e-02 masks: 19.0 20.0 [wd: 4.07e-02] [lr: 4.80e-04] [mem: 7.80e+03] (513.3 ms)
INFO:root:[15,     0] grad_stats: [7.27e-03 5.33e-04] (1.63e-04, 1.11e-02)
INFO:root:avg. loss 3.76193751e-02
INFO:root:time taken for epoch 0:01:17.962628
INFO:root:Epoch 16
INFO:root:[16,     0] loss: 3.493911e-02 masks: 23.0 16.0 [wd: 4.08e-02] [lr: 5.00e-04] [mem: 7.80e+03] (519.2 ms)
INFO:root:[16,     0] grad_stats: [1.15e-02 6.17e-04] (2.15e-04, 2.06e-02)
INFO:root:avg. loss 3.88841599e-02
INFO:root:time taken for epoch 0:01:18.777356
INFO:root:Epoch 17
INFO:root:[17,     0] loss: 3.178615e-02 masks: 33.0 12.0 [wd: 4.09e-02] [lr: 5.20e-04] [mem: 8.07e+03] (546.9 ms)
INFO:root:[17,     0] grad_stats: [1.40e-02 7.16e-04] (2.81e-04, 2.42e-02)
INFO:root:avg. loss 4.02669078e-02
INFO:root:time taken for epoch 0:01:18.288187
INFO:root:Epoch 18
INFO:root:[18,     0] loss: 3.957778e-02 masks: 25.0 16.0 [wd: 4.10e-02] [lr: 5.40e-04] [mem: 8.07e+03] (525.0 ms)
INFO:root:[18,     0] grad_stats: [1.62e-02 5.60e-04] (2.03e-04, 2.04e-02)
INFO:root:avg. loss 4.07906154e-02
INFO:root:time taken for epoch 0:01:18.676962
INFO:root:Epoch 19
INFO:root:[19,     0] loss: 3.343732e-02 masks: 26.0 16.0 [wd: 4.12e-02] [lr: 5.60e-04] [mem: 8.07e+03] (536.6 ms)
INFO:root:[19,     0] grad_stats: [8.07e-03 3.94e-04] (1.35e-04, 9.59e-03)
INFO:root:avg. loss 4.21451085e-02
INFO:root:time taken for epoch 0:01:18.314214
INFO:root:Epoch 20
INFO:root:[20,     0] loss: 4.158805e-02 masks: 23.0 16.0 [wd: 4.13e-02] [lr: 5.80e-04] [mem: 8.07e+03] (515.7 ms)
INFO:root:[20,     0] grad_stats: [1.24e-02 4.41e-04] (1.71e-04, 1.49e-02)
INFO:root:avg. loss 4.38896148e-02
INFO:root:time taken for epoch 0:01:18.595715
INFO:root:Epoch 21
INFO:root:[21,     0] loss: 4.075374e-02 masks: 24.0 16.0 [wd: 4.14e-02] [lr: 6.00e-04] [mem: 8.07e+03] (519.6 ms)
INFO:root:[21,     0] grad_stats: [9.84e-03 6.44e-04] (1.74e-04, 1.62e-02)
INFO:root:avg. loss 4.40415963e-02
INFO:root:time taken for epoch 0:01:18.362361
INFO:root:Epoch 22
INFO:root:[22,     0] loss: 5.077632e-02 masks: 8.0 20.0 [wd: 4.16e-02] [lr: 6.20e-04] [mem: 8.07e+03] (485.4 ms)
INFO:root:[22,     0] grad_stats: [7.25e-03 4.33e-04] (1.15e-04, 1.44e-02)
INFO:root:avg. loss 4.60625005e-02
INFO:root:time taken for epoch 0:01:18.330263
INFO:root:Epoch 23
INFO:root:[23,     0] loss: 4.183653e-02 masks: 26.0 16.0 [wd: 4.17e-02] [lr: 6.40e-04] [mem: 8.07e+03] (529.3 ms)
INFO:root:[23,     0] grad_stats: [1.71e-02 5.61e-04] (1.49e-04, 2.88e-02)
INFO:root:avg. loss 4.65130662e-02
INFO:root:time taken for epoch 0:01:19.227983
INFO:root:Epoch 24
INFO:root:[24,     0] loss: 5.973206e-02 masks: 17.0 16.0 [wd: 4.19e-02] [lr: 6.60e-04] [mem: 8.07e+03] (482.0 ms)
INFO:root:[24,     0] grad_stats: [8.18e-03 6.31e-04] (1.39e-04, 1.35e-02)
INFO:root:avg. loss 4.72051546e-02
INFO:root:time taken for epoch 0:01:18.832006
INFO:root:Epoch 25
INFO:root:[25,     0] loss: 4.576244e-02 masks: 19.0 20.0 [wd: 4.20e-02] [lr: 6.80e-04] [mem: 8.07e+03] (508.1 ms)
INFO:root:[25,     0] grad_stats: [1.49e-02 1.04e-03] (1.34e-04, 1.61e-02)
INFO:root:avg. loss 4.71097273e-02
INFO:root:time taken for epoch 0:01:18.752314
INFO:root:Epoch 26
INFO:root:[26,     0] loss: 5.043150e-02 masks: 17.0 20.0 [wd: 4.22e-02] [lr: 7.00e-04] [mem: 8.07e+03] (489.9 ms)
INFO:root:[26,     0] grad_stats: [1.52e-02 4.65e-04] (1.06e-04, 2.17e-02)

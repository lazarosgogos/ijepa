VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
data-path datasets/intel-image-classification/train/
Initialized ImageNet
ImageNet dataset created
ImageNet unsupervised data loader created
Using AdamW
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded optimizers from epoch 99
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar
Starting
Iteration: 0
Iteration: 1
time taken for epoch 0:00:01.499536
Total pretraining time 0:00:01.499617
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded optimizers from epoch 199
loaded optimizers from epoch 199
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.349929
time taken for epoch 0:00:01.349929
Total pretraining time 0:00:01.350025
Total pretraining time 0:00:01.350025
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded optimizers from epoch 299
loaded optimizers from epoch 299
loaded optimizers from epoch 299
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.297812
time taken for epoch 0:00:01.297812
time taken for epoch 0:00:01.297812
Total pretraining time 0:00:01.297912
Total pretraining time 0:00:01.297912
Total pretraining time 0:00:01.297912
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded optimizers from epoch 399
loaded optimizers from epoch 399
loaded optimizers from epoch 399
loaded optimizers from epoch 399
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
Starting
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.333403
time taken for epoch 0:00:01.333403
time taken for epoch 0:00:01.333403
time taken for epoch 0:00:01.333403
Total pretraining time 0:00:01.333505
Total pretraining time 0:00:01.333505
Total pretraining time 0:00:01.333505
Total pretraining time 0:00:01.333505
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
Starting
Starting
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.401004
time taken for epoch 0:00:01.401004
time taken for epoch 0:00:01.401004
time taken for epoch 0:00:01.401004
time taken for epoch 0:00:01.401004
Total pretraining time 0:00:01.401114
Total pretraining time 0:00:01.401114
Total pretraining time 0:00:01.401114
Total pretraining time 0:00:01.401114
Total pretraining time 0:00:01.401114
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
data-path datasets/intel-image-classification/train/
Initialized ImageNet
ImageNet dataset created
ImageNet unsupervised data loader created
Using AdamW
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 99 with msg: <All keys matched successfully>
loaded optimizers from epoch 99
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar
Starting
Iteration: 0
Iteration: 1
time taken for epoch 0:00:01.511747
Total pretraining time 0:00:01.511829
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 199 with msg: <All keys matched successfully>
loaded optimizers from epoch 199
loaded optimizers from epoch 199
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.346554
time taken for epoch 0:00:01.346554
Total pretraining time 0:00:01.346644
Total pretraining time 0:00:01.346644
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 299 with msg: <All keys matched successfully>
loaded optimizers from epoch 299
loaded optimizers from epoch 299
loaded optimizers from epoch 299
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.361845
time taken for epoch 0:00:01.361845
time taken for epoch 0:00:01.361845
Total pretraining time 0:00:01.361963
Total pretraining time 0:00:01.361963
Total pretraining time 0:00:01.361963
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 399 with msg: <All keys matched successfully>
loaded optimizers from epoch 399
loaded optimizers from epoch 399
loaded optimizers from epoch 399
loaded optimizers from epoch 399
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar
Starting
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.389243
time taken for epoch 0:00:01.389243
time taken for epoch 0:00:01.389243
time taken for epoch 0:00:01.389243
Total pretraining time 0:00:01.389335
Total pretraining time 0:00:01.389335
Total pretraining time 0:00:01.389335
Total pretraining time 0:00:01.389335
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
working on file logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar out of ['logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep400.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep100.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep200.pth.tar', 'logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep300.pth.tar']...
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
Initialized (rank/world-size) 0/1
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
train.py: _GLOBAL_SEED=0
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(15, 15), stride=(15, 15))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
making imagenet data transforms
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
data-path datasets/intel-image-classification/train/
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
Initialized ImageNet
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet dataset created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
ImageNet unsupervised data loader created
Using AdamW
Using AdamW
Using AdamW
Using AdamW
Using AdamW
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded pretrained encoder from epoch 499 with msg: <All keys matched successfully>
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
loaded optimizers from epoch 499
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
read-path: logs_PKT_full/iic-train-L2_PKT_full-seed21/jepa-iic-L2_PKT_batch-ep500.pth.tar
Starting
Starting
Starting
Starting
Starting
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 0
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
Iteration: 1
time taken for epoch 0:00:01.451149
time taken for epoch 0:00:01.451149
time taken for epoch 0:00:01.451149
time taken for epoch 0:00:01.451149
time taken for epoch 0:00:01.451149
Total pretraining time 0:00:01.451249
Total pretraining time 0:00:01.451249
Total pretraining time 0:00:01.451249
Total pretraining time 0:00:01.451249
Total pretraining time 0:00:01.451249

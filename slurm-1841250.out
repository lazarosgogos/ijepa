INFO:root:called-params cls_configs/cls-in100-multi.yaml
INFO:root:loaded params....
{   'data': {   'batch_size': 128,
                'crop_size': 224,
                'model_name': 'vit_base',
                'num_classes': 100,
                'patch_size': 14,
                'probe_checkpoints': True,
                'probe_prefix': 'jepa_in100',
                'train_dataset_path': 'datasets/imagenet100/train',
                'val_dataset_path': 'datasets/imagenet100/val'},
    'logging': {   'checkpoint_freq': 1000,
                   'eval_output': 'ocls-jepa-in100-l2-seed0.out',
                   'log_dir': 'logs_IN100/in100-vitb-l2-seed0/',
                   'log_file': 'stats-in100-l2-seed0.csv',
                   'save_path': 'classifiers/jepa-stl-l2-seed2-classifier-pretrained-vitb'},
    'message': 'Multi classification back to back',
    'meta': {'device': 'cuda:0', 'feature_extract': True},
    'multi_probing': ['logs_IN100/in100-vitb-l2-seed0/'],
    'optimization': {   'epochs': 200,
                        'lr': 0.001,
                        'use_last_n_blocks': 1,
                        'use_normalization': False}}
INFO:root:working on file logs_IN100/in100-vitb-l2-seed0/jepa_in100-ep200.pth.tar ...
Directory logs_IN100/in100-vitb-l2-seed0/classifiers for saving the classifiers is now present
VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(14, 14), stride=(14, 14))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
Extracting features...
Traceback (most recent call last):
  File "/home/l/lazarosg/thesis/ijepa/pmulti-linear-probing.py", line 450, in <module>
    process_main(args.fname) 
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/l/lazarosg/thesis/ijepa/pmulti-linear-probing.py", line 440, in process_main
    linear_prober = LinearProbe(temp_params, logger)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/l/lazarosg/thesis/ijepa/pmulti-linear-probing.py", line 188, in __init__
    train_features, train_labels = self.extract_features(self.encoder, self.train_loader_images, self.device)
                                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'LinearProbe' object has no attribute 'train_loader_images'. Did you mean: 'train_dataset_images'?
